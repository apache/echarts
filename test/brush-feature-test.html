<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>Brush Feature Test</title>
    <script src="../dist/echarts.min.js"></script>
    <style>
        body { font-family: Arial; margin: 20px; }
        #chart { width: 100%; height: 600px; border: 1px solid #ccc; }
        .test-section { margin: 20px 0; padding: 10px; background: #f5f5f5; }
        .test-result { margin-top: 10px; padding: 10px; border-left: 3px solid #ddd; }
        .pass { border-left-color: green; color: green; }
        .fail { border-left-color: red; color: red; }
    </style>
</head>
<body>
    <h1>ECharts Brush Feature Test</h1>
    
    <div class="test-section">
        <h2>Test Instructions:</h2>
        <ol>
            <li>Click "box" selection in toolbox</li>
            <li>Draw first selection box - should be visible</li>
            <li>Draw second selection box - first box should STILL be visible</li>
            <li>Check opacity: selected points should be brighter, unselected dimmer</li>
            <li>Click "clear" to remove all selections</li>
        </ol>
    </div>

    <div id="chart"></div>

    <div class="test-section">
        <h2>Test Results:</h2>
        <div id="results"></div>
    </div>

    <script>
        var chart = echarts.init(document.getElementById('chart'));

        var option = {
            brush: {
                brushMode: 'multiple',
                removeOnClick: false,
                brushStyle: {
                    opacity: 0.3,
                    borderWidth: 1,
                    borderColor: '#000'
                },
                inBrush: {
                    opacity: 1
                },
                outOfBrush: {
                    opacity: 0.3
                }
            },

            toolbox: {
                feature: {
                    brush: {
                        type: ['rect', 'polygon', 'keep', 'clear']
                    }
                }
            },

            xAxis: {
                type: 'value'
            },
            yAxis: {
                type: 'value'
            },
            series: [{
                symbolSize: 20,
                data: [
                    [10.0, 8.04],
                    [8.0, 6.95],
                    [13.0, 7.58],
                    [9.0, 8.81],
                    [11.0, 8.33],
                    [14.0, 9.96],
                    [6.0, 7.24],
                    [4.0, 4.26],
                    [12.0, 10.84],
                    [7.0, 4.82],
                    [5.0, 5.68]
                ],
                type: 'scatter'
            }]
        };

        chart.setOption(option);

        // Test results logging
        var resultsDiv = document.getElementById('results');
        
        chart.on('brush', function(event) {
            var brushData = event.batch;
            resultsDiv.innerHTML += '<div class="test-result pass">✓ Brush event fired with ' + brushData.length + ' selection(s)</div>';
            console.log('Brush areas:', event.areas);
        });

        // Check brush configuration
        var brushModel = chart.getModel().getComponent('brush');
        if (brushModel) {
            var brushMode = brushModel.get('brushMode');
            var removeOnClick = brushModel.get('removeOnClick');
            
            resultsDiv.innerHTML += '<div class="test-result ' + (brushMode === 'multiple' ? 'pass' : 'fail') + '">' +
                (brushMode === 'multiple' ? '✓' : '✗') + ' brushMode: ' + brushMode + '</div>';
            
            resultsDiv.innerHTML += '<div class="test-result ' + (removeOnClick === false ? 'pass' : 'fail') + '">' +
                (removeOnClick === false ? '✓' : '✗') + ' removeOnClick: ' + removeOnClick + '</div>';
        }

        console.log('Chart initialized with brush configuration');
    </script>
</body>
</html>
