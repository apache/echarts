{"version":3,"sources":["unknown"],"names":["global","factory","exports","module","require","define","amd","self","bmap","echarts","BMapCoordSys","api","_bmap","dimensions","_mapOffset","_api","_projection","BMap","MercatorProjection","prototype","setZoom","zoom","_zoom","setCenter","center","_center","lngLatToPoint","Point","setMapOffset","mapOffset","getBMap","dataToPoint","data","point","px","pointToOverlayPixel","x","y","pointToData","pt","overlayPixelToPoint","lng","lat","getViewRect","graphic","BoundingRect","getWidth","getHeight","getRoamTransform","matrix","create","prepareCustoms","rect","coordSys","type","width","height","coord","util","bind","size","dataToCoordSize","dataSize","dataItem","map","dimIdx","val","halfSize","p1","p2","Math","abs","Overlay","createOverlayCtor","root","_root","initialize","getPanes","labelPane","appendChild","draw","ecModel","bmapCoordSys","getDom","eachComponent","bmapModel","painter","getZr","viewportRoot","getViewportRoot","Error","__bmap","bmapRoot","querySelector","style","left","top","removeChild","document","createElement","className","cssText","mapOptions","get","clone","mapType","Map","overlay","addOverlay","getViewportRootOffset","offsetLeft","offsetTop","bmapCenter","getCenter","bmapZoom","getZoom","centerOrZoomChanged","centerAndZoom","__mapOffset","coordinateSystem","eachSeries","seriesModel","v2Equal","a","b","extendComponentModel","setCenterAndZoom","option","defaultOption","mapStyle","mapStyleV2","roam","isEmptyObject","obj","key","hasOwnProperty","extendComponentView","render","bMapModel","rendering","moveHandler","target","offsetEl","parentNode","parseInt","viewportRootStyle","dispatchAction","animation","duration","zoomEndHandler","removeEventListener","_oldMoveHandler","_oldZoomEndHandler","addEventListener","enableDragging","disableDragging","enableScrollWheelZoom","enableDoubleClickZoom","enablePinchToZoom","disableScrollWheelZoom","disableDoubleClickZoom","disablePinchToZoom","originalStyle","__mapStyle","newMapStyle","mapStyleStr","JSON","stringify","setMapStyle","parse","originalStyle2","__mapStyle2","newMapStyle2","mapStyleStr2","setMapStyleV2","registerCoordinateSystem","registerAction","event","update","payload","version","Object","defineProperty","value"],"mappings":"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","sourcesContent":["(function (global, factory) {\n    typeof exports === 'object' && typeof module !== 'undefined' ? factory(exports, require('echarts')) :\n    typeof define === 'function' && define.amd ? define(['exports', 'echarts'], factory) :\n    (global = global || self, factory(global.bmap = {}, global.echarts));\n}(this, (function (exports, echarts) { 'use strict';\n\n    function BMapCoordSys(bmap, api) {\r\n        this._bmap = bmap;\r\n        this.dimensions = ['lng', 'lat'];\r\n        this._mapOffset = [0, 0];\r\n        this._api = api;\r\n        this._projection = new BMap.MercatorProjection();\r\n    }\r\n    BMapCoordSys.prototype.dimensions = ['lng', 'lat'];\r\n    BMapCoordSys.prototype.setZoom = function (zoom) {\r\n        this._zoom = zoom;\r\n    };\r\n    BMapCoordSys.prototype.setCenter = function (center) {\r\n        this._center = this._projection.lngLatToPoint(new BMap.Point(center[0], center[1]));\r\n    };\r\n    BMapCoordSys.prototype.setMapOffset = function (mapOffset) {\r\n        this._mapOffset = mapOffset;\r\n    };\r\n    BMapCoordSys.prototype.getBMap = function () {\r\n        return this._bmap;\r\n    };\r\n    BMapCoordSys.prototype.dataToPoint = function (data) {\r\n        var point = new BMap.Point(data[0], data[1]);\r\n        var px = this._bmap.pointToOverlayPixel(point);\r\n        var mapOffset = this._mapOffset;\r\n        return [px.x - mapOffset[0], px.y - mapOffset[1]];\r\n    };\r\n    BMapCoordSys.prototype.pointToData = function (pt) {\r\n        var mapOffset = this._mapOffset;\r\n        pt = this._bmap.overlayPixelToPoint({\r\n            x: pt[0] + mapOffset[0],\r\n            y: pt[1] + mapOffset[1]\r\n        });\r\n        return [pt.lng, pt.lat];\r\n    };\r\n    BMapCoordSys.prototype.getViewRect = function () {\r\n        var api = this._api;\r\n        return new echarts.graphic.BoundingRect(0, 0, api.getWidth(), api.getHeight());\r\n    };\r\n    BMapCoordSys.prototype.getRoamTransform = function () {\r\n        return echarts.matrix.create();\r\n    };\r\n    BMapCoordSys.prototype.prepareCustoms = function () {\r\n        var rect = this.getViewRect();\r\n        return {\r\n            coordSys: {\r\n                type: 'bmap',\r\n                x: rect.x,\r\n                y: rect.y,\r\n                width: rect.width,\r\n                height: rect.height\r\n            },\r\n            api: {\r\n                coord: echarts.util.bind(this.dataToPoint, this),\r\n                size: echarts.util.bind(dataToCoordSize, this)\r\n            }\r\n        };\r\n    };\r\n    function dataToCoordSize(dataSize, dataItem) {\r\n        dataItem = dataItem || [0, 0];\r\n        return echarts.util.map([0, 1], function (dimIdx) {\r\n            var val = dataItem[dimIdx];\r\n            var halfSize = dataSize[dimIdx] / 2;\r\n            var p1 = [];\r\n            var p2 = [];\r\n            p1[dimIdx] = val - halfSize;\r\n            p2[dimIdx] = val + halfSize;\r\n            p1[1 - dimIdx] = p2[1 - dimIdx] = dataItem[1 - dimIdx];\r\n            return Math.abs(this.dataToPoint(p1)[dimIdx] - this.dataToPoint(p2)[dimIdx]);\r\n        }, this);\r\n    }\r\n    var Overlay;\r\n    BMapCoordSys.dimensions = BMapCoordSys.prototype.dimensions;\r\n    function createOverlayCtor() {\r\n        function Overlay(root) {\r\n            this._root = root;\r\n        }\r\n        Overlay.prototype = new BMap.Overlay();\r\n        Overlay.prototype.initialize = function (map) {\r\n            map.getPanes().labelPane.appendChild(this._root);\r\n            return this._root;\r\n        };\r\n        Overlay.prototype.draw = function () { };\r\n        return Overlay;\r\n    }\r\n    BMapCoordSys.create = function (ecModel, api) {\r\n        var bmapCoordSys;\r\n        var root = api.getDom();\r\n        ecModel.eachComponent('bmap', function (bmapModel) {\r\n            var painter = api.getZr().painter;\r\n            var viewportRoot = painter.getViewportRoot();\r\n            if (typeof BMap === 'undefined') {\r\n                throw new Error('BMap api is not loaded');\r\n            }\r\n            Overlay = Overlay || createOverlayCtor();\r\n            if (bmapCoordSys) {\r\n                throw new Error('Only one bmap component can exist');\r\n            }\r\n            var bmap;\r\n            if (!bmapModel.__bmap) {\r\n                var bmapRoot = root.querySelector('.ec-extension-bmap');\r\n                if (bmapRoot) {\r\n                    viewportRoot.style.left = '0px';\r\n                    viewportRoot.style.top = '0px';\r\n                    root.removeChild(bmapRoot);\r\n                }\r\n                bmapRoot = document.createElement('div');\r\n                bmapRoot.className = 'ec-extension-bmap';\r\n                bmapRoot.style.cssText = 'position:absolute;width:100%;height:100%';\r\n                root.appendChild(bmapRoot);\r\n                var mapOptions = bmapModel.get('mapOptions');\r\n                if (mapOptions) {\r\n                    mapOptions = echarts.util.clone(mapOptions);\r\n                    delete mapOptions.mapType;\r\n                }\r\n                bmap = bmapModel.__bmap = new BMap.Map(bmapRoot, mapOptions);\r\n                var overlay = new Overlay(viewportRoot);\r\n                bmap.addOverlay(overlay);\r\n                painter.getViewportRootOffset = function () {\r\n                    return { offsetLeft: 0, offsetTop: 0 };\r\n                };\r\n            }\r\n            bmap = bmapModel.__bmap;\r\n            var center = bmapModel.get('center');\r\n            var zoom = bmapModel.get('zoom');\r\n            if (center && zoom) {\r\n                var bmapCenter = bmap.getCenter();\r\n                var bmapZoom = bmap.getZoom();\r\n                var centerOrZoomChanged = bmapModel.centerOrZoomChanged([bmapCenter.lng, bmapCenter.lat], bmapZoom);\r\n                if (centerOrZoomChanged) {\r\n                    var pt = new BMap.Point(center[0], center[1]);\r\n                    bmap.centerAndZoom(pt, zoom);\r\n                }\r\n            }\r\n            bmapCoordSys = new BMapCoordSys(bmap, api);\r\n            bmapCoordSys.setMapOffset(bmapModel.__mapOffset || [0, 0]);\r\n            bmapCoordSys.setZoom(zoom);\r\n            bmapCoordSys.setCenter(center);\r\n            bmapModel.coordinateSystem = bmapCoordSys;\r\n        });\r\n        ecModel.eachSeries(function (seriesModel) {\r\n            if (seriesModel.get('coordinateSystem') === 'bmap') {\r\n                seriesModel.coordinateSystem = bmapCoordSys;\r\n            }\r\n        });\r\n    };\n\n    function v2Equal(a, b) {\r\n        return a && b && a[0] === b[0] && a[1] === b[1];\r\n    }\r\n    echarts.extendComponentModel({\r\n        type: 'bmap',\r\n        getBMap: function () {\r\n            return this.__bmap;\r\n        },\r\n        setCenterAndZoom: function (center, zoom) {\r\n            this.option.center = center;\r\n            this.option.zoom = zoom;\r\n        },\r\n        centerOrZoomChanged: function (center, zoom) {\r\n            var option = this.option;\r\n            return !(v2Equal(center, option.center) && zoom === option.zoom);\r\n        },\r\n        defaultOption: {\r\n            center: [104.114129, 37.550339],\r\n            zoom: 5,\r\n            mapStyle: {},\r\n            mapStyleV2: {},\r\n            mapOptions: {},\r\n            roam: false\r\n        }\r\n    });\n\n    function isEmptyObject(obj) {\r\n        for (var key in obj) {\r\n            if (obj.hasOwnProperty(key)) {\r\n                return false;\r\n            }\r\n        }\r\n        return true;\r\n    }\r\n    echarts.extendComponentView({\r\n        type: 'bmap',\r\n        render: function (bMapModel, ecModel, api) {\r\n            var rendering = true;\r\n            var bmap = bMapModel.getBMap();\r\n            var viewportRoot = api.getZr().painter.getViewportRoot();\r\n            var coordSys = bMapModel.coordinateSystem;\r\n            var moveHandler = function (type, target) {\r\n                if (rendering) {\r\n                    return;\r\n                }\r\n                var offsetEl = viewportRoot.parentNode.parentNode.parentNode;\r\n                var mapOffset = [\r\n                    -parseInt(offsetEl.style.left, 10) || 0,\r\n                    -parseInt(offsetEl.style.top, 10) || 0\r\n                ];\r\n                var viewportRootStyle = viewportRoot.style;\r\n                var offsetLeft = mapOffset[0] + 'px';\r\n                var offsetTop = mapOffset[1] + 'px';\r\n                if (viewportRootStyle.left !== offsetLeft) {\r\n                    viewportRootStyle.left = offsetLeft;\r\n                }\r\n                if (viewportRootStyle.top !== offsetTop) {\r\n                    viewportRootStyle.top = offsetTop;\r\n                }\r\n                coordSys.setMapOffset(mapOffset);\r\n                bMapModel.__mapOffset = mapOffset;\r\n                api.dispatchAction({\r\n                    type: 'bmapRoam',\r\n                    animation: {\r\n                        duration: 0\r\n                    }\r\n                });\r\n            };\r\n            function zoomEndHandler() {\r\n                if (rendering) {\r\n                    return;\r\n                }\r\n                api.dispatchAction({\r\n                    type: 'bmapRoam',\r\n                    animation: {\r\n                        duration: 0\r\n                    }\r\n                });\r\n            }\r\n            bmap.removeEventListener('moving', this._oldMoveHandler);\r\n            bmap.removeEventListener('moveend', this._oldMoveHandler);\r\n            bmap.removeEventListener('zoomend', this._oldZoomEndHandler);\r\n            bmap.addEventListener('moving', moveHandler);\r\n            bmap.addEventListener('moveend', moveHandler);\r\n            bmap.addEventListener('zoomend', zoomEndHandler);\r\n            this._oldMoveHandler = moveHandler;\r\n            this._oldZoomEndHandler = zoomEndHandler;\r\n            var roam = bMapModel.get('roam');\r\n            if (roam && roam !== 'scale') {\r\n                bmap.enableDragging();\r\n            }\r\n            else {\r\n                bmap.disableDragging();\r\n            }\r\n            if (roam && roam !== 'move') {\r\n                bmap.enableScrollWheelZoom();\r\n                bmap.enableDoubleClickZoom();\r\n                bmap.enablePinchToZoom();\r\n            }\r\n            else {\r\n                bmap.disableScrollWheelZoom();\r\n                bmap.disableDoubleClickZoom();\r\n                bmap.disablePinchToZoom();\r\n            }\r\n            var originalStyle = bMapModel.__mapStyle;\r\n            var newMapStyle = bMapModel.get('mapStyle') || {};\r\n            var mapStyleStr = JSON.stringify(newMapStyle);\r\n            if (JSON.stringify(originalStyle) !== mapStyleStr) {\r\n                if (!isEmptyObject(newMapStyle)) {\r\n                    bmap.setMapStyle(echarts.util.clone(newMapStyle));\r\n                }\r\n                bMapModel.__mapStyle = JSON.parse(mapStyleStr);\r\n            }\r\n            var originalStyle2 = bMapModel.__mapStyle2;\r\n            var newMapStyle2 = bMapModel.get('mapStyleV2') || {};\r\n            var mapStyleStr2 = JSON.stringify(newMapStyle2);\r\n            if (JSON.stringify(originalStyle2) !== mapStyleStr2) {\r\n                if (!isEmptyObject(newMapStyle2)) {\r\n                    bmap.setMapStyleV2(echarts.util.clone(newMapStyle2));\r\n                }\r\n                bMapModel.__mapStyle2 = JSON.parse(mapStyleStr2);\r\n            }\r\n            rendering = false;\r\n        }\r\n    });\n\n    echarts.registerCoordinateSystem('bmap', BMapCoordSys);\r\n    echarts.registerAction({\r\n        type: 'bmapRoam',\r\n        event: 'bmapRoam',\r\n        update: 'updateLayout'\r\n    }, function (payload, ecModel) {\r\n        ecModel.eachComponent('bmap', function (bMapModel) {\r\n            var bmap = bMapModel.getBMap();\r\n            var center = bmap.getCenter();\r\n            bMapModel.setCenterAndZoom([center.lng, center.lat], bmap.getZoom());\r\n        });\r\n    });\r\n    var version = '1.0.0';\n\n    exports.version = version;\n\n    Object.defineProperty(exports, '__esModule', { value: true });\n\n})));\n\n"]}