{"version":3,"sources":["unknown"],"names":["global","factory","exports","module","require","define","amd","self","bmap","echarts","BMapCoordSys","api","_bmap","dimensions","_mapOffset","_api","_projection","BMap","MercatorProjection","prototype","setZoom","zoom","_zoom","setCenter","center","_center","lngLatToPoint","Point","setMapOffset","mapOffset","getBMap","dataToPoint","data","point","px","pointToOverlayPixel","x","y","pointToData","pt","overlayPixelToPoint","lng","lat","getViewRect","graphic","BoundingRect","getWidth","getHeight","getRoamTransform","matrix","create","prepareCustoms","rect","coordSys","type","width","height","coord","util","bind","size","dataToCoordSize","dataSize","dataItem","map","dimIdx","val","halfSize","p1","p2","Math","abs","Overlay","createOverlayCtor","root","_root","initialize","getPanes","labelPane","appendChild","draw","ecModel","bmapCoordSys","getDom","eachComponent","bmapModel","painter","getZr","viewportRoot","getViewportRoot","Error","__bmap","bmapRoot","querySelector","style","left","top","removeChild","document","createElement","cssText","classList","add","Map","overlay","addOverlay","getViewportRootOffset","offsetLeft","offsetTop","get","centerAndZoom","__mapOffset","coordinateSystem","eachSeries","seriesModel","v2Equal","a","b","extendComponentModel","setCenterAndZoom","option","centerOrZoomChanged","defaultOption","mapStyle","mapStyleV2","roam","BUILTIN_OBJECT","TYPED_ARRAY","objToString","Object","toString","arrayProto","Array","nativeSlice","slice","ctorFunction","constructor","protoFunction","clone","source","result","typeStr","call","isPrimitive","i","len","length","Ctor","from","isDom","key","hasOwnProperty","bindPolyfill","func","context","args","_i","arguments","apply","concat","isFunction","value","nodeType","ownerDocument","primitiveKey","obj","extendComponentView","render","bMapModel","rendering","moveHandler","target","offsetEl","parentNode","parseInt","dispatchAction","animation","duration","zoomEndHandler","removeEventListener","_oldMoveHandler","_oldZoomEndHandler","addEventListener","enableDragging","disableDragging","enableScrollWheelZoom","enableDoubleClickZoom","enablePinchToZoom","disableScrollWheelZoom","disableDoubleClickZoom","disablePinchToZoom","originalStyle","__mapStyle","newMapStyle","mapStyleStr","JSON","stringify","keys","setMapStyle","parse","originalStyle2","__mapStyle2","newMapStyle2","mapStyleStr2","setMapStyleV2","registerCoordinateSystem","registerAction","event","update","payload","getCenter","getZoom","version","defineProperty"],"mappings":"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","sourcesContent":["(function (global, factory) {\n    typeof exports === 'object' && typeof module !== 'undefined' ? factory(exports, require('echarts')) :\n    typeof define === 'function' && define.amd ? define(['exports', 'echarts'], factory) :\n    (global = global || self, factory(global.bmap = {}, global.echarts));\n}(this, (function (exports, echarts) { 'use strict';\n\n    function BMapCoordSys(bmap, api) {\r\n        this._bmap = bmap;\r\n        this.dimensions = ['lng', 'lat'];\r\n        this._mapOffset = [0, 0];\r\n        this._api = api;\r\n        this._projection = new BMap.MercatorProjection();\r\n    }\r\n    BMapCoordSys.prototype.dimensions = ['lng', 'lat'];\r\n    BMapCoordSys.prototype.setZoom = function (zoom) {\r\n        this._zoom = zoom;\r\n    };\r\n    BMapCoordSys.prototype.setCenter = function (center) {\r\n        this._center = this._projection.lngLatToPoint(new BMap.Point(center[0], center[1]));\r\n    };\r\n    BMapCoordSys.prototype.setMapOffset = function (mapOffset) {\r\n        this._mapOffset = mapOffset;\r\n    };\r\n    BMapCoordSys.prototype.getBMap = function () {\r\n        return this._bmap;\r\n    };\r\n    BMapCoordSys.prototype.dataToPoint = function (data) {\r\n        var point = new BMap.Point(data[0], data[1]);\r\n        var px = this._bmap.pointToOverlayPixel(point);\r\n        var mapOffset = this._mapOffset;\r\n        return [px.x - mapOffset[0], px.y - mapOffset[1]];\r\n    };\r\n    BMapCoordSys.prototype.pointToData = function (pt) {\r\n        var mapOffset = this._mapOffset;\r\n        pt = this._bmap.overlayPixelToPoint({\r\n            x: pt[0] + mapOffset[0],\r\n            y: pt[1] + mapOffset[1]\r\n        });\r\n        return [pt.lng, pt.lat];\r\n    };\r\n    BMapCoordSys.prototype.getViewRect = function () {\r\n        var api = this._api;\r\n        return new echarts.graphic.BoundingRect(0, 0, api.getWidth(), api.getHeight());\r\n    };\r\n    BMapCoordSys.prototype.getRoamTransform = function () {\r\n        return echarts.matrix.create();\r\n    };\r\n    BMapCoordSys.prototype.prepareCustoms = function () {\r\n        var rect = this.getViewRect();\r\n        return {\r\n            coordSys: {\r\n                type: 'bmap',\r\n                x: rect.x,\r\n                y: rect.y,\r\n                width: rect.width,\r\n                height: rect.height\r\n            },\r\n            api: {\r\n                coord: echarts.util.bind(this.dataToPoint, this),\r\n                size: echarts.util.bind(dataToCoordSize, this)\r\n            }\r\n        };\r\n    };\r\n    function dataToCoordSize(dataSize, dataItem) {\r\n        dataItem = dataItem || [0, 0];\r\n        return echarts.util.map([0, 1], function (dimIdx) {\r\n            var val = dataItem[dimIdx];\r\n            var halfSize = dataSize[dimIdx] / 2;\r\n            var p1 = [];\r\n            var p2 = [];\r\n            p1[dimIdx] = val - halfSize;\r\n            p2[dimIdx] = val + halfSize;\r\n            p1[1 - dimIdx] = p2[1 - dimIdx] = dataItem[1 - dimIdx];\r\n            return Math.abs(this.dataToPoint(p1)[dimIdx] - this.dataToPoint(p2)[dimIdx]);\r\n        }, this);\r\n    }\r\n    var Overlay;\r\n    BMapCoordSys.dimensions = BMapCoordSys.prototype.dimensions;\r\n    function createOverlayCtor() {\r\n        function Overlay(root) {\r\n            this._root = root;\r\n        }\r\n        Overlay.prototype = new BMap.Overlay();\r\n        Overlay.prototype.initialize = function (map) {\r\n            map.getPanes().labelPane.appendChild(this._root);\r\n            return this._root;\r\n        };\r\n        Overlay.prototype.draw = function () { };\r\n        return Overlay;\r\n    }\r\n    BMapCoordSys.create = function (ecModel, api) {\r\n        var bmapCoordSys;\r\n        var root = api.getDom();\r\n        ecModel.eachComponent('bmap', function (bmapModel) {\r\n            var painter = api.getZr().painter;\r\n            var viewportRoot = painter.getViewportRoot();\r\n            if (typeof BMap === 'undefined') {\r\n                throw new Error('BMap api is not loaded');\r\n            }\r\n            Overlay = Overlay || createOverlayCtor();\r\n            if (bmapCoordSys) {\r\n                throw new Error('Only one bmap component can exist');\r\n            }\r\n            var bmap;\r\n            if (!bmapModel.__bmap) {\r\n                var bmapRoot = root.querySelector('.ec-extension-bmap');\r\n                if (bmapRoot) {\r\n                    viewportRoot.style.left = '0px';\r\n                    viewportRoot.style.top = '0px';\r\n                    root.removeChild(bmapRoot);\r\n                }\r\n                bmapRoot = document.createElement('div');\r\n                bmapRoot.style.cssText = 'width:100%;height:100%';\r\n                bmapRoot.classList.add('ec-extension-bmap');\r\n                root.appendChild(bmapRoot);\r\n                bmap = bmapModel.__bmap = new BMap.Map(bmapRoot);\r\n                var overlay = new Overlay(viewportRoot);\r\n                bmap.addOverlay(overlay);\r\n                painter.getViewportRootOffset = function () {\r\n                    return { offsetLeft: 0, offsetTop: 0 };\r\n                };\r\n            }\r\n            bmap = bmapModel.__bmap;\r\n            var center = bmapModel.get('center');\r\n            var zoom = bmapModel.get('zoom');\r\n            if (center && zoom) {\r\n                var pt = new BMap.Point(center[0], center[1]);\r\n                bmap.centerAndZoom(pt, zoom);\r\n            }\r\n            bmapCoordSys = new BMapCoordSys(bmap, api);\r\n            bmapCoordSys.setMapOffset(bmapModel.__mapOffset || [0, 0]);\r\n            bmapCoordSys.setZoom(zoom);\r\n            bmapCoordSys.setCenter(center);\r\n            bmapModel.coordinateSystem = bmapCoordSys;\r\n        });\r\n        ecModel.eachSeries(function (seriesModel) {\r\n            if (seriesModel.get('coordinateSystem') === 'bmap') {\r\n                seriesModel.coordinateSystem = bmapCoordSys;\r\n            }\r\n        });\r\n    };\n\n    function v2Equal(a, b) {\r\n        return a && b && a[0] === b[0] && a[1] === b[1];\r\n    }\r\n    echarts.extendComponentModel({\r\n        type: 'bmap',\r\n        getBMap: function () {\r\n            return this.__bmap;\r\n        },\r\n        setCenterAndZoom: function (center, zoom) {\r\n            this.option.center = center;\r\n            this.option.zoom = zoom;\r\n        },\r\n        centerOrZoomChanged: function (center, zoom) {\r\n            var option = this.option;\r\n            return !(v2Equal(center, option.center) && zoom === option.zoom);\r\n        },\r\n        defaultOption: {\r\n            center: [104.114129, 37.550339],\r\n            zoom: 5,\r\n            mapStyle: {},\r\n            mapStyleV2: {},\r\n            roam: false\r\n        }\r\n    });\n\n    var BUILTIN_OBJECT = {\r\n        '[object Function]': true,\r\n        '[object RegExp]': true,\r\n        '[object Date]': true,\r\n        '[object Error]': true,\r\n        '[object CanvasGradient]': true,\r\n        '[object CanvasPattern]': true,\r\n        '[object Image]': true,\r\n        '[object Canvas]': true\r\n    };\r\n    var TYPED_ARRAY = {\r\n        '[object Int8Array]': true,\r\n        '[object Uint8Array]': true,\r\n        '[object Uint8ClampedArray]': true,\r\n        '[object Int16Array]': true,\r\n        '[object Uint16Array]': true,\r\n        '[object Int32Array]': true,\r\n        '[object Uint32Array]': true,\r\n        '[object Float32Array]': true,\r\n        '[object Float64Array]': true\r\n    };\r\n    var objToString = Object.prototype.toString;\r\n    var arrayProto = Array.prototype;\r\n    var nativeSlice = arrayProto.slice;\r\n    var ctorFunction = (function () { }).constructor;\r\n    var protoFunction = ctorFunction ? ctorFunction.prototype : null;\r\n    function clone(source) {\r\n        if (source == null || typeof source !== 'object') {\r\n            return source;\r\n        }\r\n        var result = source;\r\n        var typeStr = objToString.call(source);\r\n        if (typeStr === '[object Array]') {\r\n            if (!isPrimitive(source)) {\r\n                result = [];\r\n                for (var i = 0, len = source.length; i < len; i++) {\r\n                    result[i] = clone(source[i]);\r\n                }\r\n            }\r\n        }\r\n        else if (TYPED_ARRAY[typeStr]) {\r\n            if (!isPrimitive(source)) {\r\n                var Ctor = source.constructor;\r\n                if (Ctor.from) {\r\n                    result = Ctor.from(source);\r\n                }\r\n                else {\r\n                    result = new Ctor(source.length);\r\n                    for (var i = 0, len = source.length; i < len; i++) {\r\n                        result[i] = clone(source[i]);\r\n                    }\r\n                }\r\n            }\r\n        }\r\n        else if (!BUILTIN_OBJECT[typeStr] && !isPrimitive(source) && !isDom(source)) {\r\n            result = {};\r\n            for (var key in source) {\r\n                if (source.hasOwnProperty(key)) {\r\n                    result[key] = clone(source[key]);\r\n                }\r\n            }\r\n        }\r\n        return result;\r\n    }\r\n    function bindPolyfill(func, context) {\r\n        var args = [];\r\n        for (var _i = 2; _i < arguments.length; _i++) {\r\n            args[_i - 2] = arguments[_i];\r\n        }\r\n        return function () {\r\n            return func.apply(context, args.concat(nativeSlice.call(arguments)));\r\n        };\r\n    }\r\n    var bind = (protoFunction && isFunction(protoFunction.bind))\r\n        ? protoFunction.call.bind(protoFunction.bind)\r\n        : bindPolyfill;\r\n    function isFunction(value) {\r\n        return typeof value === 'function';\r\n    }\r\n    function isDom(value) {\r\n        return typeof value === 'object'\r\n            && typeof value.nodeType === 'number'\r\n            && typeof value.ownerDocument === 'object';\r\n    }\r\n    var primitiveKey = '__ec_primitive__';\r\n    function isPrimitive(obj) {\r\n        return obj[primitiveKey];\r\n    }\n\n    echarts.extendComponentView({\r\n        type: 'bmap',\r\n        render: function (bMapModel, ecModel, api) {\r\n            var rendering = true;\r\n            var bmap = bMapModel.getBMap();\r\n            var viewportRoot = api.getZr().painter.getViewportRoot();\r\n            var coordSys = bMapModel.coordinateSystem;\r\n            var moveHandler = function (type, target) {\r\n                if (rendering) {\r\n                    return;\r\n                }\r\n                var offsetEl = viewportRoot.parentNode.parentNode.parentNode;\r\n                var mapOffset = [\r\n                    -parseInt(offsetEl.style.left, 10) || 0,\r\n                    -parseInt(offsetEl.style.top, 10) || 0\r\n                ];\r\n                viewportRoot.style.left = mapOffset[0] + 'px';\r\n                viewportRoot.style.top = mapOffset[1] + 'px';\r\n                coordSys.setMapOffset(mapOffset);\r\n                bMapModel.__mapOffset = mapOffset;\r\n                api.dispatchAction({\r\n                    type: 'bmapRoam',\r\n                    animation: {\r\n                        duration: 0\r\n                    }\r\n                });\r\n            };\r\n            function zoomEndHandler() {\r\n                if (rendering) {\r\n                    return;\r\n                }\r\n                api.dispatchAction({\r\n                    type: 'bmapRoam',\r\n                    animation: {\r\n                        duration: 0\r\n                    }\r\n                });\r\n            }\r\n            bmap.removeEventListener('moving', this._oldMoveHandler);\r\n            bmap.removeEventListener('zoomend', this._oldZoomEndHandler);\r\n            bmap.addEventListener('moving', moveHandler);\r\n            bmap.addEventListener('zoomend', zoomEndHandler);\r\n            this._oldMoveHandler = moveHandler;\r\n            this._oldZoomEndHandler = zoomEndHandler;\r\n            var roam = bMapModel.get('roam');\r\n            if (roam && roam !== 'scale') {\r\n                bmap.enableDragging();\r\n            }\r\n            else {\r\n                bmap.disableDragging();\r\n            }\r\n            if (roam && roam !== 'move') {\r\n                bmap.enableScrollWheelZoom();\r\n                bmap.enableDoubleClickZoom();\r\n                bmap.enablePinchToZoom();\r\n            }\r\n            else {\r\n                bmap.disableScrollWheelZoom();\r\n                bmap.disableDoubleClickZoom();\r\n                bmap.disablePinchToZoom();\r\n            }\r\n            var originalStyle = bMapModel.__mapStyle;\r\n            var newMapStyle = bMapModel.get('mapStyle') || {};\r\n            var mapStyleStr = JSON.stringify(newMapStyle);\r\n            if (JSON.stringify(originalStyle) !== mapStyleStr) {\r\n                if (Object.keys(newMapStyle).length) {\r\n                    bmap.setMapStyle(clone(newMapStyle));\r\n                }\r\n                bMapModel.__mapStyle = JSON.parse(mapStyleStr);\r\n            }\r\n            var originalStyle2 = bMapModel.__mapStyle2;\r\n            var newMapStyle2 = bMapModel.get('mapStyleV2') || {};\r\n            var mapStyleStr2 = JSON.stringify(newMapStyle2);\r\n            if (JSON.stringify(originalStyle2) !== mapStyleStr2) {\r\n                if (Object.keys(newMapStyle2).length) {\r\n                    bmap.setMapStyleV2(clone(newMapStyle2));\r\n                }\r\n                bMapModel.__mapStyle2 = JSON.parse(mapStyleStr2);\r\n            }\r\n            rendering = false;\r\n        }\r\n    });\n\n    echarts.registerCoordinateSystem('bmap', BMapCoordSys);\r\n    echarts.registerAction({\r\n        type: 'bmapRoam',\r\n        event: 'bmapRoam',\r\n        update: 'updateLayout'\r\n    }, function (payload, ecModel) {\r\n        ecModel.eachComponent('bmap', function (bMapModel) {\r\n            var bmap = bMapModel.getBMap();\r\n            var center = bmap.getCenter();\r\n            bMapModel.setCenterAndZoom([center.lng, center.lat], bmap.getZoom());\r\n        });\r\n    });\r\n    var version = '1.0.0';\n\n    exports.version = version;\n\n    Object.defineProperty(exports, '__esModule', { value: true });\n\n})));\n\n"]}